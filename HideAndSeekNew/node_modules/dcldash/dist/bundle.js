import{movePlayerTo}from"@decentraland/RestrictedActions";import{getParcel}from"@decentraland/ParcelIdentity";import{getUserData}from"@decentraland/Identity";import{isPreviewMode}from"@decentraland/EnvironmentAPI";function __awaiter(t,e,i,s){return new(i||(i=Promise))((function(o,a){function fulfilled(t){try{step(s.next(t))}catch(t){a(t)}}function rejected(t){try{step(s.throw(t))}catch(t){a(t)}}function step(t){var e;t.done?o(t.value):(e=t.value,e instanceof i?e:new i((function(t){t(e)}))).then(fulfilled,rejected)}step((s=s.apply(t,e||[])).next())}))}const boxHighlightTexture=new Texture("https://pmacom.github.io/assets/dcldash/images/textures/boxHighlight.png"),uvs={1:[.6,.4,.9,.4,.9,.1,.6,.01,.6,.4,.9,.4,.9,.1,.6,.01],2:[0,.5,.5,.5,.5,0,0,0,0,.5,.5,.5,.5,0,0,0],3:[.5,1,.5,.5,0,.5,0,1,.5,1,.5,.5,0,.5,0,1],4:[0,.5,0,1,.5,1,.5,.5,0,.5,0,1,.5,1,.5,.5],5:[0,1,.5,1,.5,.5,0,.5,0,1,.5,1,.5,.5,0,.5],6:[.5,.5,0,.5,0,1,.5,1,.5,.5,0,.5,0,1,.5,1]};let BoxHighlightAnimation=class{constructor(t=1){this.speed=t}};BoxHighlightAnimation=function(t,e,i,s){var o,a=arguments.length,n=a<3?e:null===s?s=Object.getOwnPropertyDescriptor(e,i):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(t,e,i,s);else for(var h=t.length-1;h>=0;h--)(o=t[h])&&(n=(a<3?o(n):a>3?o(e,i,n):o(e,i))||n);return a>3&&n&&Object.defineProperty(e,i,n),n}([Component("BoxHighlightAnimation")],BoxHighlightAnimation);const getTransform=(t,e,i=!1)=>{let s=.5*(i?-1:1),o="x"==e?90:0,a="y"==e?90:0,n="z"==e?90:0;return new Transform({position:new Vector3("x"==t?s:0,"y"==t?s:0,"z"==t?s:0),scale:new Vector3(1,1,1),rotation:(new Quaternion).setEuler(o,a,n)})};
/*!
 * Creates an animated cube to highlight something in DCL
 * it can be rotated to point in a predetermined direction
 * @public
 */class Dash_BoxHighlight extends Entity{constructor(t,e,i="top",s=!0,o,a){super(),this.position=t,this.scale=e,this.dir=i,this.visible=s,this.texture=o,this.onClick=a,this.timer=0,this.duration=3,this.sideTopEntity=new Entity,this.sideTopShape=new PlaneShape,this.sideBottomEntity=new Entity,this.sideBottomShape=new PlaneShape,this.sideNorthEntity=new Entity,this.sideNorthShape=new PlaneShape,this.sideSouthEntity=new Entity,this.sideSouthShape=new PlaneShape,this.sideEastEntity=new Entity,this.sideEastShape=new PlaneShape,this.sideWestEntity=new Entity,this.sideWestShape=new PlaneShape,this.stripeMaterial=new Material,this.surfaceMaterial=new Material;let n=o||boxHighlightTexture;this.stripeMaterial.roughness=1,this.stripeMaterial.emissiveColor=new Color3(0,.5,1),this.stripeMaterial.albedoTexture=n,this.stripeMaterial.alphaTexture=n,this.stripeMaterial.castShadows=!1,this.surfaceMaterial.roughness=1,this.surfaceMaterial.emissiveColor=new Color3(10,0,0),this.surfaceMaterial.albedoTexture=n,this.surfaceMaterial.alphaTexture=n,this.surfaceMaterial.castShadows=!1,this.sides=[{shape:this.sideBottomShape,entity:this.sideBottomEntity,transform:getTransform("y","x"),startUVs:uvs[1],dir:{top:{points:uvs[1]},bottom:{points:uvs[2],isSurface:!0},north:{points:uvs[3],animate:!0},south:{points:uvs[4],animate:!0},east:{points:uvs[5],animate:!0},west:{points:uvs[6],animate:!0}}},{shape:this.sideTopShape,entity:this.sideTopEntity,transform:getTransform("y","x",!0),startUVs:uvs[1],dir:{top:{points:uvs[2],isSurface:!0},bottom:{points:uvs[1]},north:{points:uvs[3],animate:!0},south:{points:uvs[4],animate:!0},east:{points:uvs[5],animate:!0},west:{points:uvs[6],animate:!0}}},{shape:this.sideWestShape,entity:this.sideWestEntity,transform:getTransform("z",""),startUVs:uvs[1],dir:{top:{points:uvs[6],animate:!0},bottom:{points:uvs[5],animate:!0},north:{points:uvs[3],animate:!0},south:{points:uvs[4],animate:!0},east:{points:uvs[2],isSurface:!0},west:{points:uvs[1]}}},{shape:this.sideEastShape,entity:this.sideEastEntity,transform:getTransform("z","",!0),startUVs:uvs[1],dir:{top:{points:uvs[6],animate:!0},bottom:{points:uvs[5],animate:!0},north:{points:uvs[3],animate:!0},south:{points:uvs[4],animate:!0},east:{points:uvs[1]},west:{points:uvs[2],isSurface:!0}}},{shape:this.sideNorthShape,entity:this.sideNorthEntity,transform:getTransform("x","y"),startUVs:uvs[1],dir:{top:{points:uvs[6],animate:!0},bottom:{points:uvs[5],animate:!0},north:{points:uvs[1]},south:{points:uvs[2],isSurface:!0},east:{points:uvs[3],animate:!0},west:{points:uvs[4],animate:!0}}},{shape:this.sideSouthShape,entity:this.sideSouthEntity,transform:getTransform("x","y",!0),startUVs:uvs[1],dir:{top:{points:uvs[6],animate:!0},bottom:{points:uvs[5],animate:!0},north:{points:uvs[2],isSurface:!0},south:{points:uvs[1]},east:{points:uvs[3],animate:!0},west:{points:uvs[4],animate:!0}}}],this.addComponent(new Transform({position:t,scale:e})),s&&this.show(),this.setSides()}setSides(){this.sides.forEach((t=>{let{shape:e,entity:i,transform:s,dir:o}=t,{points:a,isSurface:n}=t.dir[this.dir];i.addComponentOrReplace(e),i.addComponentOrReplace(s),n||i.addComponentOrReplace(this.stripeMaterial),i.addComponentOrReplace(n?this.surfaceMaterial:this.stripeMaterial),e.withCollisions=!1,n&&this.onClick&&i.addComponent(this.onClick),t.startUVs=a,e.uvs=t.startUVs,i.setParent(this)}))}setScale(t,e,i){this.getComponent(Transform).scale.set(t,e,i)}setPosition(t,e,i){this.getComponent(Transform).position.set(t,e,i)}setDirection(t){this.dir=t,this.setSides()}setTexture(t){this.stripeMaterial.albedoTexture=t,this.stripeMaterial.alphaTexture=t,this.surfaceMaterial.albedoTexture=t,this.surfaceMaterial.alphaTexture=t}setStripeColor(t){this.stripeMaterial.emissiveColor=t}setSurfaceColor(t){this.surfaceMaterial.emissiveColor=t}show(){this.addComponentOrReplace(new BoxHighlightAnimation),engine.addEntity(this),engine.addSystem(AnimateBoxHighlightsInstance)}hide(){this.removeComponent(BoxHighlightAnimation),engine.removeEntity(this)}updateUV(t){this.timer=this.timer>=this.duration?0:this.timer+t,this.sides.forEach((t=>{t.shape.uvs&&t.dir[this.dir].animate&&(t.shape.uvs=lerpUVs(t.startUVs,this.timer,this.duration))}))}}const lerpUVs=(t,e,i)=>{let s=Scalar.Clamp(e/i,0,1),o=[Scalar.Lerp(t[0],t[0]+.5,s),Scalar.Lerp(t[1],t[1],s),Scalar.Lerp(t[2],t[2]+.5,s),Scalar.Lerp(t[3],t[3],s),Scalar.Lerp(t[4],t[4]+.5,s),Scalar.Lerp(t[5],t[5],s),Scalar.Lerp(t[6],t[6]+.5,s),Scalar.Lerp(t[7],t[7],s)];return o.concat(o)},BoxHighlights=engine.getComponentGroup(BoxHighlightAnimation),AnimateBoxHighlightsInstance=new class{constructor(){this.system=this}update(t){BoxHighlights.entities.length||this.system.active&&engine.removeSystem(this.system),BoxHighlights.entities.forEach((e=>{e.updateUV(t)}))}},Dash_CheckWithinVolume=(t,e,i)=>{const{x:s,y:o,z:a}=t,{x:n,y:h,z:r}=e,{x:l,y:c,z:u}=i,d=new Vector3(s-n/2,o-h/2,a-r/2),p=new Vector3(s+n/2,o+h/2,a+r/2);return l>d.x&&l<p.x&&c>d.y&&c<p.y&&u>d.z&&u<p.z},Dash_Material=new class{transparent(){return this._transparent||(this._transparent=new Material,this._transparent.albedoColor=new Color4(0,0,0,0),this._transparent.castShadows=!1),this._transparent}Red(){return this._Red||(this._Red=new Material,this._Red.albedoColor=new Color4(1,0,0,.5)),this._Red}Green(){return this._Green||(this._Green=new Material,this._Green.albedoColor=new Color4(0,1,0,.5)),this._Green}Blue(){return this._Blue||(this._Blue=new Material,this._Blue.albedoColor=new Color4(0,0,1,.5)),this._Blue}Black(){return this._Black||(this._Black=new Material,this._Black.albedoColor=new Color4(0,0,0,.5)),this._Black}},Dash_OnUpdateFrame=new class{constructor(){this.nonce=0,this.queue=new Map,this.system=this}add(t){const e={id:this.nonce++,onFrame:t};return{start:()=>{this.queue.set(e.id,e),this.enable()},stop:()=>{this.queue.delete(e.id)}}}update(t){this.queue.size||this.disable(),this.queue.forEach((e=>{const{id:i,onFrame:s}=e;s&&s(t)}))}enable(){this.system.active||engine.addSystem(this)}disable(){this.system.active&&engine.removeSystem(this)}};class Dash_TriggerZone extends Entity{constructor(){super(),this.onEnter=()=>{},this.onExit=()=>{},this.hasEntered=!1,engine.addEntity(this),this.checkCollision=Dash_OnUpdateFrame.add((()=>this.check())),this.checkCollision.start()}check(){let t=this.getParent(),e=new Vector3,i=new Vector3,s=new Quaternion;do{if(t){let o=t.getComponentOrCreate(Transform);e.addInPlace(o.position.clone()),i.addInPlace(o.scale.clone()),s.eulerAngles.addInPlace(o.eulerAngles),t=t.getParent()}}while(t&&"0"!==t.uuid);const o=this.getComponentOrCreate(Transform);this.getParent();const a=Dash_CheckWithinVolume(Vector3.Add(e,o.position),Vector3.Add(i,o.scale),new Vector3(Camera.instance.feetPosition.x,Camera.instance.feetPosition.y,Camera.instance.feetPosition.z));a&&!this.hasEntered?(this.onEnter(),this.debug&&this.debug.showHighlight(),this.hasEntered=!0):!a&&this.hasEntered&&(this.onExit(),this.debug&&this.debug.hideHighlight(),this.hasEntered=!1)}enableDebug(){this.debug=new TriggerDebug(this),this.debug.show()}enable(){var t;null===(t=this.checkCollision)||void 0===t||t.start()}disable(){var t;null===(t=this.checkCollision)||void 0===t||t.stop()}}class TriggerDebug extends Entity{constructor(t,e){super(),this.setParent(t),this.boxHighlight=new Dash_BoxHighlight(new Vector3,(new Vector3).setAll(1),"top"),this.boxHighlight.setParent(t),this.boxHighlight.show()}show(){this.shape=new BoxShape,this.shape.withCollisions=!1,this.material=Dash_Material.Red(),this.boxHighlight.setStripeColor(Color3.Red()),this.addComponentOrReplace(this.shape),this.addComponentOrReplace(this.material)}showHighlight(){this.material=Dash_Material.Green(),this.boxHighlight.setStripeColor(Color3.Green()),this.addComponentOrReplace(this.material)}hideHighlight(){this.material=Dash_Material.Red(),this.boxHighlight.setStripeColor(Color3.Red()),this.addComponentOrReplace(this.material)}}class DynamicImage{constructor(t){this.image=t,this.tweens=new Map,this.animation=Dash_OnUpdateFrame.add((t=>this.update(t)))}fadeIn(t,e,i){this.tweens.set("opacity",{timer:0,settings:{from:0,to:1,duration:t,ease:e,callback:i}}),this.animation.start()}fadeOut(t,e,i){this.tweens.set("opacity",{timer:0,settings:{from:this.image.opacity,to:0,duration:t,ease:e,callback:i}}),this.animation.start()}fadeTo(t,e,i,s){this.tweens.set("opacity",{timer:0,settings:{from:this.image.opacity,to:t,duration:e,ease:i,callback:s}}),this.animation.start()}moveTo(t,e,i,s,o){this.tweens.set("positionX",{timer:0,settings:{from:this.image.positionX,to:t,duration:i,ease:s,callback:o}}),this.tweens.set("positionY",{timer:0,settings:{from:this.image.positionY,to:e,duration:i,ease:s,callback:o}}),this.animation.start()}moveToX(t,e,i,s){this.tweens.set("positionX",{timer:0,settings:{from:this.image.positionX,to:t,duration:e,ease:i,callback:s}}),this.animation.start()}moveToY(t,e,i,s){this.tweens.set("positionY",{timer:0,settings:{from:this.image.positionY,to:t,duration:e,ease:i,callback:s}}),this.animation.start()}moveRelativeTo(t,e,i,s,o){this.tweens.set("positionX",{timer:0,settings:{from:this.image.positionX,to:new UIValue(this.image.positionX).value+new UIValue(t).value,duration:i,ease:s,callback:o}}),this.tweens.set("positionY",{timer:0,settings:{from:this.image.positionY,to:new UIValue(this.image.positionY).value+new UIValue(e).value,duration:i,ease:s,callback:o}}),this.animation.start()}resizeTo(t,e,i,s,o){this.tweens.set("width",{timer:0,settings:{from:this.image.width,to:t,duration:i,ease:s,callback:o}}),this.tweens.set("height",{timer:0,settings:{from:this.image.height,to:e,duration:i,ease:s,callback:o}}),this.animation.start()}resizeWidthTo(t,e,i,s){this.tweens.set("width",{timer:0,settings:{from:this.image.width,to:t,duration:e,ease:i,callback:s}}),this.animation.start()}resizeHeightTo(t,e,i,s){this.tweens.set("height",{timer:0,settings:{from:this.image.height,to:t,duration:e,ease:i,callback:s}}),this.animation.start()}moveSourceTo(t,e,i,s,o){this.tweens.set("sourceLeft",{timer:0,settings:{from:this.image.sourceLeft,to:t,duration:i,ease:s,callback:o}}),this.tweens.set("sourceTop",{timer:0,settings:{from:this.image.sourceTop,to:e,duration:i,ease:s,callback:o}}),this.animation.start()}moveSourceLeftTo(t,e,i,s){this.tweens.set("sourceLeft",{timer:0,settings:{from:this.image.sourceLeft,to:t,duration:e,ease:i,callback:s}}),this.animation.start()}moveSourceTopTo(t,e,i,s){this.tweens.set("sourceTop",{timer:0,settings:{from:this.image.sourceTop,to:t,duration:e,ease:i,callback:s}}),this.animation.start()}resizeSourceTo(t,e,i,s,o){this.tweens.set("sourceWidth",{timer:0,settings:{from:this.image.sourceWidth,to:t,duration:i,ease:s,callback:o}}),this.tweens.set("sourceHeight",{timer:0,settings:{from:this.image.sourceHeight,to:e,duration:i,ease:s,callback:o}}),this.animation.start()}resizeSourceWidthTo(t,e,i,s){this.tweens.set("sourceWidth",{timer:0,settings:{from:this.image.sourceWidth,to:t,duration:e,ease:i,callback:s}}),this.animation.start()}resizeSourceHeightTo(t,e,i,s){this.tweens.set("sourceHeight",{timer:0,settings:{from:this.image.sourceHeight,to:t,duration:e,ease:i,callback:s}}),this.animation.start()}scaleIn(t,e,i,s){this.tweens.set("width",{timer:0,settings:{from:new UIValue(this.image.width).value*new UIValue(t).value,to:this.image.width,duration:e,ease:i,callback:s}}),this.tweens.set("height",{timer:0,settings:{from:new UIValue(this.image.height).value*new UIValue(t).value,to:this.image.height,duration:e,ease:i,callback:s}}),this.tweens.set("opacity",{timer:0,settings:{from:0,to:this.image.opacity,duration:e,ease:i,callback:s}}),this.animation.start()}scaleOut(t,e,i,s){this.tweens.set("width",{timer:0,settings:{from:this.image.width,to:new UIValue(this.image.width).value*new UIValue(t).value,duration:e,ease:i,callback:s}}),this.tweens.set("height",{timer:0,settings:{from:this.image.height,to:new UIValue(this.image.height).value*new UIValue(t).value,duration:e,ease:i,callback:s}}),this.tweens.set("opacity",{timer:0,settings:{from:this.image.opacity,to:0,duration:e,ease:i,callback:s}}),this.animation.start()}scaleTo(t,e,i,s){this.tweens.set("width",{timer:0,settings:{from:this.image.width,to:new UIValue(this.image.width).value*t,duration:e,ease:i,callback:s}}),this.tweens.set("height",{timer:0,settings:{from:this.image.height,to:new UIValue(this.image.width).value*t,duration:e,ease:i,callback:s}}),this.animation.start()}update(t){this.tweens.size?this.tweens.forEach(((e,i)=>{const{settings:s}=e,{duration:o,callback:a}=s;let n,h,r,l;switch(e.timer+=t,e.timer>=o&&(a&&a(),this.tweens.delete(i)),i){case"opacity":case"sourceLeft":case"sourceTop":case"sourceWidth":case"sourceHeight":if(n=new UIValue(s.from),h=new UIValue(s.to),e.timer>=o){this.image[i]=h.value;break}r=s.ease?s.ease(e.timer/o):e.timer/o,this.image[i]=Scalar.Lerp(n.value,h.value,r);break;case"width":case"height":case"positionX":case"positionY":if(n=new UIValue(s.from),h=new UIValue(s.to),e.timer>=o){this.image[i]=1==n.type||1==h.type?h.value:`${h.value}%`;break}r=s.ease?s.ease(e.timer/o):e.timer/o,l=Scalar.Lerp(n.value,h.value,r),this.image[i]=1==n.type||1==h.type?l:`${l}%`}})):this.animation.stop()}}const easeOutBounce=t=>{const e=7.5625,i=2.75;return t<1/i?e*t*t:t<2/i?e*(t-=1.5/i)*t+.75:t<2.5/i?e*(t-=2.25/i)*t+.9375:e*(t-=2.625/i)*t+.984375},Dash_Ease=new class{easeInSine(t){return 1-Math.cos(t*Math.PI/2)}easeOutSine(t){return Math.sin(t*Math.PI/2)}easeInOutSine(t){return-(Math.cos(Math.PI*t)-1)/2}easeInCubic(t){return t*t*t}easeOutCubic(t){return 1-Math.pow(1-t,3)}easeInOutCubic(t){return t<.5?4*t*t*t:1-Math.pow(-2*t+2,3)/2}easeInQuint(t){return t*t*t*t*t}easeOutQuint(t){return 1-Math.pow(1-t,5)}easeInOutQuint(t){return t<.5?16*t*t*t*t*t:1-Math.pow(-2*t+2,5)/2}easeInCirc(t){return 1-Math.sqrt(1-Math.pow(t,2))}easeOutCirc(t){return Math.sqrt(1-Math.pow(t-1,2))}easeInOutCirc(t){return t<.5?(1-Math.sqrt(1-Math.pow(2*t,2)))/2:(Math.sqrt(1-Math.pow(-2*t+2,2))+1)/2}easeInElastic(t){const e=2*Math.PI/3;return 0===t?0:1===t?1:-Math.pow(2,10*t-10)*Math.sin((10*t-10.75)*e)}easeOutElastic(t){const e=2*Math.PI/3;return 0===t?0:1===t?1:Math.pow(2,-10*t)*Math.sin((10*t-.75)*e)+1}easeInOutElastic(t){const e=2*Math.PI/4.5;return 0===t?0:1===t?1:t<.5?-Math.pow(2,20*t-10)*Math.sin((20*t-11.125)*e)/2:Math.pow(2,-20*t+10)*Math.sin((20*t-11.125)*e)/2+1}easeInQuad(t){return t*t}easeOutQuad(t){return 1-(1-t)*(1-t)}easeInOutQuad(t){return t<.5?2*t*t:1-Math.pow(-2*t+2,2)/2}easeInQuart(t){return t*t*t*t}easeOutQuart(t){return 1-Math.pow(1-t,4)}easeInOutQuart(t){return t<.5?8*t*t*t*t:1-Math.pow(-2*t+2,4)/2}easeInExpo(t){return 0===t?0:Math.pow(2,10*t-10)}easeOutExpo(t){return 1===t?1:1-Math.pow(2,-10*t)}easeInOutExpo(t){return 0===t?0:1===t?1:t<.5?Math.pow(2,20*t-10)/2:(2-Math.pow(2,-20*t+10))/2}easeInBack(t){return 2.70158*t*t*t-1.70158*t*t}easeOutBack(t){return 1+2.70158*Math.pow(t-1,3)+1.70158*Math.pow(t-1,2)}easeInOutBack(t){const e=2.5949095;return t<.5?Math.pow(2*t,2)*(7.189819*t-e)/2:(Math.pow(2*t-2,2)*((e+1)*(2*t-2)+e)+2)/2}easeInBounce(t){return(t=>1-easeOutBounce(1-t))(t)}easeOutBounce(t){return easeOutBounce(t)}easeInOutBounce(t){return(t=>t<.5?(1-easeOutBounce(1-2*t))/2:(1+easeOutBounce(2*t-1))/2)(t)}};var DynamicBarOrientation;!function(t){t[t.HALIGN_LEFT=0]="HALIGN_LEFT",t[t.HALIGN_CENTER=1]="HALIGN_CENTER",t[t.HALIGN_RIGHT=2]="HALIGN_RIGHT",t[t.VALIGN_TOP=3]="VALIGN_TOP",t[t.VALIGN_CENTER=4]="VALIGN_CENTER",t[t.VALIGN_BOTTOM=5]="VALIGN_BOTTOM"}(DynamicBarOrientation||(DynamicBarOrientation={}));class DynamicImageBar{constructor(t,e,i=0,s=DynamicBarOrientation.HALIGN_CENTER){this.backgroundImage=t,this.orientation=s,this.ease=Dash_Ease.easeOutQuint,this.fillImage=new DynamicImage(e),this.backgroundImage.opacity=.5,this.width=new UIValue(e.width).value,this.height=new UIValue(e.height).value,this.sourceWidth=new UIValue(e.sourceWidth).value,this.sourceHeight=new UIValue(e.sourceHeight).value,this.sourceLeft=new UIValue(e.sourceLeft).value,this.sourceTop=new UIValue(e.sourceTop).value,this.value=i,this.setValue(this.value,0)}setEase(t){this.ease=t}setValue(t,e=1){const i=this.width*(t/100),s=this.height*(t/100),o=this.sourceWidth*(t/100),a=this.sourceHeight*(t/100);switch(this.orientation){case DynamicBarOrientation.HALIGN_CENTER:switch(this.fillImage.image.hAlign){case"left":this.fillImage.moveToX(this.width/2-this.width/2*Scalar.InverseLerp(0,this.sourceWidth,o),e,this.ease),this.fillImage.moveSourceLeftTo(this.sourceLeft+(this.sourceWidth-o)/2,e,this.ease);break;case"center":this.fillImage.moveSourceLeftTo(this.sourceLeft+(this.sourceWidth-o)/2,e,this.ease);break;case"right":this.fillImage.moveToX(this.width/2*-1+this.width/2*Scalar.InverseLerp(0,this.sourceWidth,o),e,this.ease),this.fillImage.moveSourceLeftTo(this.sourceLeft+(this.sourceWidth-o)/2,e,this.ease)}this.fillImage.resizeWidthTo(i,e,this.ease),this.fillImage.resizeSourceWidthTo(o,e,this.ease);break;case DynamicBarOrientation.HALIGN_LEFT:switch(this.fillImage.image.hAlign){case"left":break;case"center":this.fillImage.moveToX(this.width/2+this.width/2*Scalar.InverseLerp(0,this.sourceWidth,o)-this.width,e,this.ease);break;case"right":this.fillImage.moveToX(this.width*Scalar.InverseLerp(0,this.sourceWidth,o)-this.width,e,this.ease)}this.fillImage.resizeWidthTo(i,e,this.ease),this.fillImage.resizeSourceWidthTo(o,e,this.ease);break;case DynamicBarOrientation.HALIGN_RIGHT:switch(this.fillImage.image.hAlign){case"left":this.fillImage.moveToX(this.width+this.width*Scalar.InverseLerp(this.sourceWidth,0,o)-this.width,e,this.ease),this.fillImage.moveSourceLeftTo(this.sourceLeft+(this.sourceWidth-o),e,this.ease);break;case"center":this.fillImage.moveToX(this.width+this.width/2*Scalar.InverseLerp(this.sourceWidth,0,o)-this.width,e,this.ease),this.fillImage.moveSourceLeftTo(this.sourceLeft+(this.sourceWidth-o),e,this.ease);break;case"right":this.fillImage.moveSourceLeftTo(this.sourceLeft+(this.sourceWidth-o),e,this.ease),this.fillImage.moveToX(0,e,this.ease)}this.fillImage.resizeWidthTo(i,e,this.ease),this.fillImage.resizeSourceWidthTo(o,e,this.ease);break;case DynamicBarOrientation.VALIGN_CENTER:switch(this.fillImage.image.vAlign){case"top":this.fillImage.moveToY(this.height/2*Scalar.InverseLerp(0,this.sourceHeight,a)-this.height/2,e,this.ease),this.fillImage.moveSourceTopTo(this.sourceTop+(this.sourceHeight-a)/2,e,this.ease);break;case"center":this.fillImage.moveSourceTopTo(this.sourceTop+(this.sourceHeight-a)/2,e,this.ease);break;case"bottom":this.fillImage.moveToY(this.height/2*Scalar.InverseLerp(this.sourceHeight,0,a),e,this.ease),this.fillImage.moveSourceTopTo(this.sourceTop+(this.sourceHeight-a)/2,e,this.ease)}this.fillImage.resizeHeightTo(s,e,this.ease),this.fillImage.resizeSourceHeightTo(a,e,this.ease);break;case DynamicBarOrientation.VALIGN_TOP:switch(this.fillImage.image.vAlign){case"top":break;case"center":this.fillImage.moveToY(this.height/2-this.height/2*Scalar.InverseLerp(0,this.sourceHeight,a),e,this.ease);break;case"bottom":this.fillImage.moveToY(this.height-this.height*Scalar.InverseLerp(0,this.sourceHeight,a),e,this.ease),this.fillImage.moveSourceTopTo(0,e,this.ease)}this.fillImage.resizeHeightTo(s,e,this.ease),this.fillImage.resizeSourceHeightTo(a,e,this.ease);break;case DynamicBarOrientation.VALIGN_BOTTOM:switch(this.fillImage.image.vAlign){case"top":this.fillImage.moveToY(this.height*Scalar.InverseLerp(this.sourceHeight,0,a)*-1,e,this.ease),this.fillImage.moveSourceTopTo(this.sourceHeight-a,e,this.ease);break;case"center":this.fillImage.moveToY(this.height/2*Scalar.InverseLerp(this.sourceHeight,0,a)*-1,e,this.ease),this.fillImage.moveSourceTopTo(this.sourceHeight-a,e,this.ease);break;case"bottom":this.fillImage.moveToY(Scalar.InverseLerp(0,this.sourceHeight,a),e,this.ease),this.fillImage.moveSourceTopTo(this.sourceHeight-a,e,this.ease)}this.fillImage.resizeHeightTo(s,e,this.ease),this.fillImage.resizeSourceHeightTo(a,e,this.ease)}}}class Dash_Countdown{constructor(){this.remaining=0,this.seconds=0,this.onCompleteMap=new Set,this.onUpdateMap=new Set,this.onSecondMap=new Set,this.timer=Dash_OnUpdateFrame.add((t=>this.onFrame(t)))}setTimer(t){this.remaining=this.seconds=t}onUpdate(t){this.onUpdateMap.add(t)}onSecond(t){this.onSecondMap.add(t)}onComplete(t){this.onCompleteMap.add(t)}start(){this.timer.start()}stop(){this.timer.stop()}onFrame(t){if(this.remaining>0){this.remaining-=t;let e=Math.floor(this.remaining);e!=this.seconds&&(this.seconds=e,this.onSecondMap.forEach((t=>t(e))))}this.seconds<=0&&(this.onCompleteMap.forEach((t=>t())),this.timer.stop()),this.onUpdateMap.forEach((e=>e(t)))}}const Dash_UV_Curved_Video=(t,e)=>{let i=t/100*2,s=i*e,o=i*e+i,a=[s,1,o,1,o,0,s,0];return[...a,...a]},Dash_UV_Curved_Image=(t,e)=>{let i=t/100*2,s=i*e,o=i*e+i,a=[s,0,o,0,o,1,s,1];return[...a,...a]},Dash_UV_Video=()=>[0,1,1,1,1,0,0,0,1,1,0,1,0,0,1,0],Dash_UV_Image=()=>[1,0,0,0,0,1,1,1,0,0,1,0,1,1,0,1],Dash_UV_Crop_Video=(t,e,i,s,o,a)=>{const n=[Scalar.InverseLerp(0,t,o+i),Scalar.InverseLerp(0,e,a+s),Scalar.InverseLerp(0,t,o),Scalar.InverseLerp(0,e,a+s),Scalar.InverseLerp(0,t,o),Scalar.InverseLerp(0,e,a),Scalar.InverseLerp(0,t,o+i),Scalar.InverseLerp(0,e,a)];return[...n,...n]},Dash_UV_Plane_Crop_Image=(t,e,i,s,o,a,n)=>{let h=Scalar.InverseLerp(0,t,o),r=Scalar.InverseLerp(0,e,a),l=Scalar.InverseLerp(0,t,i),c=Scalar.InverseLerp(0,e,s),u={x:h,y:1-r},d={x:h+l,y:1-r},p={x:h+l,y:1-r-c},g={x:h,y:1-r-c},m=n?[u.x,u.y,d.x,d.y,p.x,p.y,g.x,g.y]:[g.x,g.y,p.x,p.y,d.x,d.y,u.x,u.y];return[...m,...m]};class Dash_SimplePoster extends Entity{constructor(){super(),this.shape=new PlaneShape,this.material=new Material,this.hyperlink=null,this.addComponent(this.shape),this.addComponent(this.material),this.addComponent(new Transform),this.shape.uvs=[1,0,0,0,0,1,1,1,0,0,1,0,1,1,0,1]}setHyperlink(t){this.hyperlink=t,this.addComponentOrReplace(new OnPointerDown((t=>{this.hyperlink&&openExternalURL(this.hyperlink)})))}setImageUrl(t){this.texture=new Texture(t),this.material.albedoTexture=this.texture,this.material.emissiveColor=Color3.White(),this.material.emissiveTexture=this.texture,this.material.emissiveIntensity=1,this.addComponentOrReplace(this.material)}show(){this.alive||engine.addEntity(this)}hide(){this.alive&&engine.removeEntity(this)}}const Dash_GetSceneData=()=>__awaiter(void 0,void 0,void 0,(function*(){const t=yield getParcel(),e=t.land.sceneJsonData.scene.base,i=t.land.sceneJsonData.scene.parcels;return{base:e,parcels:i,maxHeight:Math.ceil(Math.log(i.length+1)*Math.LOG2E*20)}})),texture=new Texture("https://pmacom.github.io/assets/dcldash/images/landBarrier/barrier-sprite.png",{hasAlpha:!1,samplingMode:0,wrap:1}),material=new Material;material.albedoTexture=texture,material.emissiveColor=Color3.White(),material.emissiveTexture=texture,material.emissiveIntensity=5,material.transparencyMode=2;const BarrierMaterial=material,BarrierImageData={comingsoon:{sourcePositionTop:9,sourcePositionLeft:0,sourceWidth:1024,sourceHeight:86},privateevent:{sourcePositionTop:104,sourcePositionLeft:0,sourceWidth:1024,sourceHeight:86},accountrequired:{sourcePositionTop:198,sourcePositionLeft:0,sourceWidth:1024,sourceHeight:86},nftrequired:{sourcePositionTop:293,sourcePositionLeft:0,sourceWidth:1024,sourceHeight:86},temporarilylocked:{sourcePositionTop:388,sourcePositionLeft:0,sourceWidth:1024,sourceHeight:86},outdated:{sourcePositionTop:482,sourcePositionLeft:0,sourceWidth:1024,sourceHeight:86},undermaintenance:{sourcePositionTop:577,sourcePositionLeft:0,sourceWidth:1024,sourceHeight:86},loadfully:{sourcePositionTop:671,sourcePositionLeft:0,sourceWidth:1024,sourceHeight:86},transparent:{sourcePositionTop:924,sourcePositionLeft:0,sourceWidth:100,sourceHeight:100}};class Dash_LandBarrier{constructor(t){this.exitLocation=t,this.barrierZones=[],this.parcelStrings=new Set,this.message="privateevent",executeTask((()=>__awaiter(this,void 0,void 0,(function*(){const{base:t,parcels:e,maxHeight:i}=yield Dash_GetSceneData(),s=t.split(",");this.base=new Vector2(parseInt(s[0]),parseInt(s[1])),e.forEach((t=>this.parcelStrings.add(t))),e.forEach(((t,e)=>{const s=t.split(","),o=new Vector2(parseInt(s[0]),parseInt(s[1])),a=new Vector2(o.x-this.base.x,o.y-this.base.y),n=new Vector3(16*a.x+8,1,16*a.y+8),h=!this.parcelStrings.has(`${o.x-1},${o.y}`),r=!this.parcelStrings.has(`${o.x+1},${o.y}`),l=!this.parcelStrings.has(`${o.x},${o.y+1}`),c=!this.parcelStrings.has(`${o.x},${o.y-1}`),u=new BarrierZone(BarrierMaterial,this.getMessage(),i,this.exitLocation,h,r,l,c);u.addComponentOrReplace(new Transform({position:n})),this.barrierZones.push(u)}))}))))}getMessage(){return this.message}setMessage(t){this.message=t,this.barrierZones.forEach((e=>{e.setMessage(t)}))}disable(){this.barrierZones.forEach((t=>{t.disable(),t.alive&&engine.removeEntity(t)}))}enable(){this.barrierZones.forEach((t=>{t.enable(),t.alive||engine.addEntity(t)}))}}class BarrierZone extends Entity{constructor(t,e="privateevent",i,s,o,a,n,h){if(super(),this.material=t,this.message=e,this.maxHeight=i,this.exitLocation=s,this.shapes=[],this.collider=new Entity,this.colliderShape=new BoxShape,this.triggerZone=new Dash_TriggerZone,this.collider.addComponent(this.colliderShape),this.collider.addComponent(Dash_Material.transparent()),this.collider.addComponent(new Transform({scale:new Vector3(16,8,16)})),this.collider.setParent(this),this.triggerZone.addComponent(new Transform({position:new Vector3(0,7,0),scale:new Vector3(16,16,16)})),this.triggerZone.onEnter=()=>{const{x:t,y:e,z:i}=this.exitLocation;movePlayerTo({x:t,y:e,z:i})},this.triggerZone.setParent(this),this.addComponent(new Transform({position:new Vector3(0,0,0)})),n){const e=new BarrierPlane(new Vector3(0,1,8),0,this.message);e.addComponent(t),this.shapes.push(e.shape),e.setParent(this)}if(h){const e=new BarrierPlane(new Vector3(0,1,-8),180,this.message);e.addComponent(t),this.shapes.push(e.shape),e.setParent(this)}if(a){const e=new BarrierPlane(new Vector3(8,1,0),90,this.message);e.addComponent(t),this.shapes.push(e.shape),e.setParent(this)}if(o){const e=new BarrierPlane(new Vector3(-8,1,0),-90,this.message);e.addComponent(t),this.shapes.push(e.shape),e.setParent(this)}this.animation=Dash_OnUpdateFrame.add((t=>{this.shapes.forEach((e=>{let i=e.uvs.map(((e,i)=>i%2==0?e+.05*t:e));e.uvs=i}))})),this.animation.start(),engine.addEntity(this)}setMessage(t){this.shapes.forEach((e=>{if(BarrierImageData[t]){const i=BarrierImageData[t],{sourceHeight:s,sourceWidth:o,sourcePositionLeft:a,sourcePositionTop:n}=i;e.uvs=Dash_UV_Plane_Crop_Image(1024,1024,o,s,a,n)}}))}setExitLocation(t){this.exitLocation=t}disable(){this.triggerZone.disable()}enable(){this.triggerZone.enable()}}class BarrierPlane extends Entity{constructor(t,e=0,i){super(),this.shape=new PlaneShape,this.addComponent(this.shape),this.shape.withCollisions=!1,this.setMessage(i),this.addComponent(new Transform({position:t,scale:new Vector3(16,1,1),rotation:(new Quaternion).setEuler(0,e,0)}))}setMessage(t){if(BarrierImageData[t]){const e=BarrierImageData[t],{sourceHeight:i,sourceWidth:s,sourcePositionLeft:o,sourcePositionTop:a}=e;this.shape.uvs=Dash_UV_Plane_Crop_Image(1024,1024,s,i,o,a)}}}const sceneMessageBus=new MessageBus,zones=new Map;class ParcelHideAvatar extends Entity{constructor(){super(),this.addComponent(new Transform),engine.addEntity(this)}}const ZoneManager=new class{constructor(){this.parcelHideAvatars=[],this.zones=new Map,this.currentZone="primaryZone",this.setupMessages(),executeTask((()=>__awaiter(this,void 0,void 0,(function*(){const{base:t,parcels:e,maxHeight:i}=yield Dash_GetSceneData(),s=yield getUserData();this.userId=s.userId,this.zones.set("primaryZone",new Set),this.parcelSize=new Vector3(16,i,16);const o=t.split(",");this.base=new Vector2(parseInt(o[0]),parseInt(o[1])),e.forEach(((t,e)=>{const i=t.split(","),s=new Vector2(parseInt(i[0]),parseInt(i[1])),o=new Vector2(s.x-this.base.x,s.y-this.base.y),a=new Vector3(16*o.x+8,1,16*o.y+8),n=this.parcelSize,h=new ParcelHideAvatar;h.addComponentOrReplace(new Transform({position:a,scale:n})),this.parcelHideAvatars.push(h)})),onEnterSceneObservable.add((t=>{t.userId==this.userId&&(sceneMessageBus.emit("dash-zone-enter",{userId:this.userId,zoneName:"primaryZone"}),this.addUserToZone("primaryZone",t.userId))})),onLeaveSceneObservable.add((t=>{t.userId==this.userId&&(sceneMessageBus.emit("dash-zone-exit",{userId:this.userId,zoneName:"primaryZone"}),this.addUserToZone("primaryZone",t.userId))})),onPlayerConnectedObservable.add((({userId:t})=>{sceneMessageBus.emit("dash-zone-query",{userId:this.userId})})),onPlayerDisconnectedObservable.add((({userId:t})=>{this.removeUserFromAllZones(t)})),sceneMessageBus.emit("dash-zone-query",{userId:this.userId})}))))}removeUserFromAllZones(t){this.zones.forEach(((e,i)=>{e.delete(t)}))}addUserToZone(t,e){e==this.userId?this.currentZone=t:(this.removeUserFromAllZones(e),this.zones.has(t)?this.zones.get(t).add(e):this.zones.set(t,new Set([e]))),this.updateParcelHideAvatars()}getUserIdsForZone(t){const e=[];return(this.zones.has(t)?this.zones.get(t):new Set).forEach((t=>e.push(t))),[this.userId,...e]}updateParcelHideAvatars(){const t=this.getUserIdsForZone(this.currentZone);this.parcelHideAvatars.forEach((e=>{e.addComponentOrReplace(new AvatarModifierArea({area:{box:this.parcelSize},modifiers:[AvatarModifiers.HIDE_AVATARS],excludeIds:t}))}))}setupMessages(){sceneMessageBus.on("dash-zone-query",(({userId:t})=>{t!==this.userId&&sceneMessageBus.emit("dash-zone-enter",{userId:this.userId,zoneName:this.currentZone})})),sceneMessageBus.on("dash-zone-enter",(({userId:t,zoneName:e})=>{t!==this.userId&&this.addUserToZone(e,t)})),sceneMessageBus.on("dash-zone-exit",(({userId:t,zoneName:e})=>{t!==this.userId&&this.addUserToZone("primaryZone",t)}))}};class Dash_Zone extends Entity{constructor(t,e){super(),this.zoneName=t,this.transform=e,this.triggerZone=new Dash_TriggerZone,this.inZone=!1,this.excludeIds=new Set,this.excludeIdsArray=[],zones.set(t,this),this.addComponent(e),engine.addEntity(this),executeTask((()=>__awaiter(this,void 0,void 0,(function*(){let t=yield getUserData();this.userId=t.userId,this.setupTriggerZone()}))))}setupTriggerZone(){this.triggerZone.enable(),this.triggerZone.addComponent(this.transform),this.triggerZone.onEnter=()=>this.onEnter(),this.triggerZone.onExit=()=>this.onExit()}onEnter(){ZoneManager.addUserToZone(this.zoneName,this.userId),sceneMessageBus.emit("dash-zone-enter",{userId:this.userId,zoneName:this.zoneName})}onExit(){ZoneManager.addUserToZone("primaryZone",this.userId),sceneMessageBus.emit("dash-zone-exit",{userId:this.userId,zoneName:this.zoneName})}enable(){this.triggerZone.enable()}disable(){this.triggerZone.disable()}enableDebug(){this.triggerZone.enableDebug()}}class Dash_ZoneMaker extends Entity{constructor(t){super(),this.startPosition=t,this.shape=new BoxShape,this.material=new Material,this.minPosition=new Vector3,this.maxPosition=new Vector3,this.initialFeetPosition=new Vector3,this.hasMoved=!1,this.isOn=!1,this.bh=new Dash_BoxHighlight(new Vector3,(new Vector3).setAll(1),"top"),this.bh.setParent(this),this.addComponent(this.shape),this.addComponent(new Transform({position:this.startPosition.clone(),scale:new Vector3(1,1,1)})),this.shape.withCollisions=!1,engine.addEntity(this),this.material.albedoColor=new Color4(0,1,1,.1),this.addComponent(this.material);const e=Dash_OnUpdateFrame.add((()=>{const t=Camera.instance.feetPosition;if(!this.hasMoved&&Vector3.Distance(t,this.initialFeetPosition)>.1&&(this.hasMoved=!0),this.hasMoved){const{x:e,y:i,z:s}=t,{x:o,y:a,z:n}=this.minPosition,{x:h,y:r,z:l}=this.maxPosition,c=this.startPosition.x-e,u=this.startPosition.y-i,d=this.startPosition.z-s;c<o&&(this.minPosition.x=c),u<a&&(this.minPosition.y=u),d<n&&(this.minPosition.z=d),c>h&&(this.maxPosition.x=c),u>r&&(this.maxPosition.y=u),d>l&&(this.maxPosition.z=d);const p=Vector3.Add(this.minPosition.negate(),this.startPosition),g=Vector3.Add(this.maxPosition.negate(),this.startPosition),m=Vector3.Center(p,g);this.getComponent(Transform).position=Vector3.Add(m,new Vector3(0,.75,0)),this.getComponent(Transform).scale=new Vector3(this.maxPosition.x-this.minPosition.x,this.maxPosition.y-this.minPosition.y+1.5,this.maxPosition.z-this.minPosition.z)}}));this.addComponent(new OnPointerDown((()=>{if(this.isOn){e.stop();const t=this.getComponent(Transform).position,i=this.getComponent(Transform).scale;log(`Zone Transform: \nposition: new Vector3(${t.x}, ${t.y}, ${t.z}),\nscale: new Vector3(${i.x}, ${i.y}, ${i.z})`),this.isOn=!1}else this.hasMoved=!1,this.initialFeetPosition=Camera.instance.feetPosition.clone(),e.start(),this.isOn=!0})))}}const Dash_AnimationQueue=new class{constructor(){this.nonce=0,this.queue=new Map,this.system=this}add(t){return t.id=this.nonce++,this.queue.set(t.id,t),this.enable(),t}update(t){this.queue.size||this.disable(),this.queue.forEach((e=>{const{id:i,onFrame:s,onComplete:o,duration:a,data:n}=e;e.timer||(e.timer=0),e.timer+=t;const h=e.timer/a;s&&s(h,n),e.timer>=a&&(s&&s(1,n),o&&o(),this.queue.delete(i))}))}enable(){this.system.active||engine.addSystem(this)}disable(){this.system.active&&engine.removeSystem(this)}},Dash_GlobalCanvas=new UICanvas,Dash_Cache_Texture=new class{constructor(){this.textures=new Map}create(t){if(this.textures.has(t))return this.textures.get(t);const e=new Texture(t);return this.textures.set(t,e),e}},Dash_Cache_VideoClip=new class{constructor(){this.clips=new Map}create(t){if(this.clips.has(t))return this.clips.get(t);const e=new VideoClip(t);return this.clips.set(t,e),e}},Dash_Cache_VideoTexture=new class{constructor(){this.videoTextures=new Map}create(t){if(this.videoTextures.has(t))return this.videoTextures.get(t);const e=Dash_Cache_VideoClip.create(t),i=new VideoTexture(e);return this.videoTextures.set(t,i),i}},Dash_Cache_VideoMaterial=new class{constructor(){this.videoMaterials=new Map}create(t){if(this.videoMaterials.has(t))return this.videoMaterials.get(t);const e=Dash_Cache_VideoTexture.create(t),i=new Material;return i.albedoTexture=e,i.emissiveColor=Color3.White(),i.emissiveTexture=e,this.videoMaterials.set(t,i),i}};class Dash_UI_AdminRadioButton{constructor(t,e,i,s,o,a,n=!1){this.texture=t,this.value=e,this.renderSettings=i,this.onButtonSettings=s,this.offButtonSettings=o,this.onChange=a,this.isActive=n,this.image=new UIImage(Dash_GlobalCanvas,this.texture),this.image.onClick=new OnPointerDown((()=>{this.onChange(this.value)})),this.image.positionX=i.positionX,this.image.positionY=i.positionY,this.image.width=i.width,this.image.height=i.height,this.setValues(this.isActive?s:o)}setValues(t){this.image.sourceLeft=t.positionX,this.image.sourceTop=t.positionY,this.image.sourceWidth=t.width,this.image.sourceHeight=t.height,this.image.vAlign="top",this.image.hAlign="left"}turnOn(){this.setValues(this.onButtonSettings)}turnOff(){this.setValues(this.offButtonSettings)}}class Dash_UI_AdminRadioButton_Group{constructor(t,e,i){this.update=i,this.mapping=new Map,this.value="1",Object.keys(e).forEach((i=>{const s=e[i],{on:o,off:a,renderSettings:n}=s,h=new Dash_UI_AdminRadioButton(t,i,n,o,a,(t=>{this.mapping.forEach(((e,i)=>{`${t}`==`${i}`?e.turnOn():e.turnOff()})),this.update(t)}));i==this.value&&h.turnOn(),this.mapping.set(i,h)}))}setValue(t){this.value=t,this.mapping.forEach(((e,i)=>{`${t}`==`${i}`?e.turnOn():e.turnOff()}))}hide(){this.mapping.forEach((t=>{t.image.visible=!1}))}show(){this.mapping.forEach((t=>{t.image.visible=!0}))}}class Dash_Admin_Tweaker_InfoDetails{constructor(t){this.detailValues=new Map;const e=new InfoDetailValue(t,"position.x");e.text.positionX=129,e.text.positionY=52,this.detailValues.set("position.x",e);const i=new InfoDetailValue(t,"position.y");i.text.positionX=129,i.text.positionY=32,this.detailValues.set("position.y",i);const s=new InfoDetailValue(t,"position.z");s.text.positionX=129,s.text.positionY=12,this.detailValues.set("position.z",s);const o=new InfoDetailValue(t,"scale.x");o.text.positionX=176,o.text.positionY=52,this.detailValues.set("scale.x",o);const a=new InfoDetailValue(t,"scale.y");a.text.positionX=176,a.text.positionY=32,this.detailValues.set("scale.y",a);const n=new InfoDetailValue(t,"scale.z");n.text.positionX=176,n.text.positionY=12,this.detailValues.set("scale.z",n);const h=new InfoDetailValue(t,"rotation.eulerAngles.x");h.text.positionX=223,h.text.positionY=52,this.detailValues.set("rotation.eulerAngles.x",h);const r=new InfoDetailValue(t,"rotation.eulerAngles.y");r.text.positionX=223,r.text.positionY=32,this.detailValues.set("rotation.eulerAngles.y",r);const l=new InfoDetailValue(t,"rotation.eulerAngles.z");l.text.positionX=223,l.text.positionY=12,this.detailValues.set("rotation.eulerAngles.z",l),this.nameField=new UIText(t),this.nameField.fontSize=15,this.nameField.fontSize=9,this.nameField.opacity=1,this.nameField.positionX=108,this.nameField.positionY=-22,this.nameField.hTextAlign="left",this.setInfo()}setInitialValues(t,e,i=!1){this.detailValues.has(t)&&this.detailValues.get(t).setInitialValue(e,i)}set(t,e,i=!1){this.detailValues.has(t)&&this.detailValues.get(t).setValue(e,i)}clear(){this.detailValues.forEach((t=>{t.setInitialValue(0),this.setInfo()}))}setInfo(t){if(t){const{uuid:e,name:i}=t;this.nameField.value=`UUID: ${e}\nName: ${i||"No Name"}`}else this.nameField.value="No Entity Selected"}}class InfoDetailValue{constructor(t,e){this.path=e,this.initialValue="0",this.text=new UIText(t),this.text.fontSize=10,this.text.value="",this.text.fontSize=9,this.text.opacity=.5}setInitialValue(t,e=!1){let i=formatText(t);this.text.value=i,this.initialValue=i,this.text.opacity=.5}setValue(t,e=!1){let i=formatText(t,e);i!==this.initialValue&&(this.text.opacity=1),this.text.value=i}}const formatText=(t,e=!1)=>t?parseFloat(`${t}`).toFixed(e?2:3):"0";class TweakerSelector extends Entity{constructor(){super("Dash_Tweaker_Selector"),this.shape=new BoxShape,this.shape.isPointerBlocker=!1,this.shape.withCollisions=!1,this.addComponent(this.shape),this.addComponent(new Transform),this.addComponent(Dash_Material.Green())}}const TweakerPositionUnits={5:{renderSettings:{positionX:0,positionY:43*.68,vAlign:"top",hAlign:"left",width:80*.68,height:30.6},off:{positionX:80,positionY:43,width:80,height:45},on:{positionX:0,positionY:43,width:80,height:45}},1:{renderSettings:{positionX:0,positionY:59.84,vAlign:"top",hAlign:"left",width:80*.68,height:40*.68},off:{positionX:80,positionY:88,width:80,height:40},on:{positionX:0,positionY:88,width:80,height:40}},.1:{renderSettings:{positionX:0,positionY:87.04,vAlign:"top",hAlign:"left",width:80*.68,height:41*.68},off:{positionX:80,positionY:128,width:80,height:41},on:{positionX:0,positionY:128,width:80,height:41}},.01:{renderSettings:{positionX:0,positionY:114.92,width:80*.68,height:41*.68},off:{positionX:80,positionY:169,width:80,height:41},on:{positionX:0,positionY:169,width:80,height:41}},.001:{renderSettings:{positionX:0,positionY:142.8,width:80*.68,height:33.32},off:{positionX:80,positionY:210,width:80,height:49},on:{positionX:0,positionY:210,width:80,height:49}}},TweakerRotationUnits={90:{renderSettings:{positionX:0,positionY:43*.68,vAlign:"top",hAlign:"left",width:80*.68,height:30.6},off:{positionX:80,positionY:302,width:80,height:43},on:{positionX:0,positionY:302,width:80,height:43}},45:{renderSettings:{positionX:0,positionY:59.84,vAlign:"top",hAlign:"left",width:80*.68,height:40*.68},off:{positionX:80,positionY:345,width:80,height:40},on:{positionX:0,positionY:345,width:80,height:40}},5:{renderSettings:{positionX:0,positionY:87.04,vAlign:"top",hAlign:"left",width:80*.68,height:41*.68},off:{positionX:80,positionY:385,width:80,height:41},on:{positionX:0,positionY:385,width:80,height:41}},1:{renderSettings:{positionX:0,positionY:114.92,width:80*.68,height:41*.68},off:{positionX:80,positionY:426,width:80,height:40},on:{positionX:0,positionY:426,width:80,height:40}},.1:{renderSettings:{positionX:0,positionY:142.8,width:80*.68,height:33.32},off:{positionX:80,positionY:466,width:80,height:49},on:{positionX:0,positionY:466,width:80,height:49}}},ModeToggleTabButtons={position:{renderSettings:{positionX:141.44,positionY:0,width:114*.68,height:34},on:{positionX:288,positionY:0,width:114,height:50},off:{positionX:288,positionY:260,width:114,height:50}},rotation:{renderSettings:{positionX:218.96,positionY:0,width:76.84,height:34},on:{positionX:402,positionY:260,width:113,height:50},off:{positionX:402,positionY:0,width:113,height:50}}},TweakerStaticImages={labelUnit:{renderSettings:{positionX:0,positionY:0,width:80*.68,height:43*.68},cropSettings:{positionX:80,positionY:0,width:80,height:43}},labelScale:{renderSettings:{positionX:80*.68,positionY:0,width:85,height:43*.68},cropSettings:{positionX:160,positionY:0,width:125,height:43}},directionTL:{renderSettings:{positionX:141.44,positionY:-34,width:81*.68,height:43.52},cropSettings:{positionX:288,positionY:50,width:81,height:64}},directionTR:{renderSettings:{positionX:357*.68,positionY:-34,width:78*.68,height:43.52},cropSettings:{positionX:437,positionY:50,width:78,height:64}},directionBL:{renderSettings:{positionX:141.44,positionY:183*.68*-1,width:81*.68,height:77*.68},cropSettings:{positionX:288,positionY:183,width:81,height:77}},directionBR:{renderSettings:{positionX:357*.68,positionY:183*.68*-1,width:78*.68,height:77*.68},cropSettings:{positionX:437,positionY:183,width:78,height:77}},infoPaneTest:{renderSettings:{positionX:295.8,positionY:-0,width:165.24,height:207*.68},cropSettings:{positionX:515,positionY:0,width:243,height:207}}},SelectButtons={selectOn:{renderSettings:{positionX:490*.68,positionY:207*.68*-1,width:63.92,height:55*.68},cropSettings:{positionX:608,positionY:438,width:94,height:55},data:{action:"setSelectOff"}},selectOff:{renderSettings:{positionX:490*.68,positionY:207*.68*-1,width:63.92,height:55*.68},cropSettings:{positionX:514,positionY:438,width:94,height:55},data:{action:"setSelectOn"}},deselect:{renderSettings:{positionX:490*.68,positionY:207*.68*-1,width:63.92,height:55*.68},cropSettings:{positionX:570,positionY:207,width:94,height:55},data:{action:"deselect"}}},TweakerScaleButtonImages={scaleXMinus:{renderSettings:{positionX:80*.68,positionY:43*.68*-1,width:43.52,height:36.04},cropSettings:{positionX:160,positionY:43,width:64,height:53},data:{direction:"x",negative:!0}},scaleXPlus:{renderSettings:{positionX:97.92,positionY:43*.68*-1,width:61*.68,height:36.04},cropSettings:{positionX:224,positionY:43,width:61,height:53},data:{direction:"x",positive:!0}},scaleYMinus:{renderSettings:{positionX:80*.68,positionY:-65.28,width:43.52,height:35.36},cropSettings:{positionX:160,positionY:96,width:64,height:52},data:{direction:"y",positive:!1}},scaleYPlus:{renderSettings:{positionX:97.92,positionY:-65.28,width:61*.68,height:35.36},cropSettings:{positionX:224,positionY:96,width:61,height:52},data:{direction:"y",positive:!0}},scaleZMinus:{renderSettings:{positionX:80*.68,positionY:-100.64,width:43.52,height:36.04},cropSettings:{positionX:160,positionY:148,width:64,height:53},data:{direction:"z",positive:!1}},scaleZPlus:{renderSettings:{positionX:97.92,positionY:-100.64,width:61*.68,height:36.04},cropSettings:{positionX:224,positionY:148,width:61,height:53},data:{direction:"z",positive:!0}},scaleAllMinus:{renderSettings:{positionX:80*.68,positionY:-136.68,width:43.52,height:58*.68},cropSettings:{positionX:160,positionY:201,width:64,height:58},data:{direction:"all",positive:!1}},scaleAllPlus:{renderSettings:{positionX:97.92,positionY:-136.68,width:61*.68,height:58*.68},cropSettings:{positionX:224,positionY:201,width:61,height:58},data:{direction:"all",positive:!0}}},TweakerPositionButtonImages={north:{renderSettings:{positionX:196.52,positionY:-34,width:46.24,height:43.52},cropSettings:{positionX:369,positionY:50,width:68,height:64},data:{direction:"x",positive:!0}},south:{renderSettings:{positionX:196.52,positionY:183*.68*-1,width:46.24,height:77*.68},cropSettings:{positionX:369,positionY:183,width:68,height:77},data:{direction:"x",positive:!1}},east:{renderSettings:{positionX:357*.68,positionY:114*.68*-1,width:78*.68,height:46.92},cropSettings:{positionX:437,positionY:114,width:78,height:69},data:{direction:"z",positive:!0}},west:{renderSettings:{positionX:141.44,positionY:114*.68*-1,width:81*.68,height:46.92},cropSettings:{positionX:288,positionY:114,width:81,height:69},data:{direction:"z",positive:!1}},up:{renderSettings:{positionX:196.52,positionY:114*.68*-1,width:46.24,height:23.12},cropSettings:{positionX:369,positionY:114,width:68,height:34},data:{direction:"y",positive:!0}},down:{renderSettings:{positionX:196.52,positionY:-100.64,width:46.24,height:23.8},cropSettings:{positionX:369,positionY:148,width:68,height:35},data:{direction:"y",positive:!1}}},TweakerInfoButtons={revert:{renderSettings:{positionX:295.8,positionY:207*.68*-1,width:55*.68,height:55*.68},cropSettings:{positionX:515,positionY:207,width:55,height:55},data:{action:"revert"}},log:{renderSettings:{positionX:397.12,positionY:207*.68*-1,width:63.92,height:56*.68},cropSettings:{positionX:664,positionY:207,width:94,height:56},data:{action:"log"}}};var TweakerMode;!function(t){t[t.POSITION=0]="POSITION",t[t.ROTATION=1]="ROTATION"}(TweakerMode||(TweakerMode={}));class Dash_UI_ImageRadioButton{constructor(t,e,i,s,o,a=!1){this.parent=t,this.texture=e,this.value=i,this.settings=s,this.onChange=o,this.isActive=a,this.image=new UIImage(this.parent,this.texture),this.image.onClick=new OnPointerDown((()=>{this.onChange(this.value)}));const{on:n,off:h}=this.settings;this.setValues(this.isActive?n:h)}setValues(t){const{width:e,height:i,vAlign:s,hAlign:o,positionX:a,positionY:n}=this.settings.renderSettings;this.image.width=e,this.image.height=i,this.image.sourceLeft=t.positionX,this.image.sourceTop=t.positionY,this.image.sourceWidth=t.width,this.image.sourceHeight=t.height,this.image.positionX=a,this.image.positionY=-1*n,this.image.vAlign=s||"top",this.image.hAlign=o||"left"}turnOn(){this.setValues(this.settings.on)}turnOff(){this.setValues(this.settings.off)}}class Dash_UI_ImageRadioButton_Group{constructor(t,e,i,s){this.update=s,this.mapping=new Map,this.value="1",Object.keys(i).forEach((s=>{const o=i[s],a=new Dash_UI_ImageRadioButton(t,e,s,o,(t=>{this.mapping.forEach(((e,i)=>{`${t}`==`${i}`?e.turnOn():e.turnOff()})),this.update(t)}));s==this.value&&a.turnOn(),this.mapping.set(s,a)}))}setValue(t){this.value=t,this.mapping.forEach(((e,i)=>{`${t}`==`${i}`?e.turnOn():e.turnOff()}))}hide(){this.mapping.forEach((t=>{t.image.visible=!1}))}show(){this.mapping.forEach((t=>{t.image.visible=!0}))}}const Dash_UI_Generate_StaticImages=(t,e,i)=>{const s=[];return Object.keys(i).forEach((o=>{const a=i[o],n=Dash_UI_StaticImage(t,e,a);s.push(n)})),s},Dash_UI_Generate_StaticButtons=(t,e,i,s)=>{const o=[];return Object.keys(i).forEach((a=>{const n=i[a],h=Dash_UI_Generate_StaticButton(t,e,n,s);o.push(h)})),o},Dash_UI_Generate_StaticButton=(t,e,i,s)=>{const o=Dash_UI_StaticImage(t,e,i);return o.onClick=new OnPointerDown((()=>s(i.data))),o},Dash_UI_StaticImage=(t,e,i)=>{let s=new UIImage(t,e);const{renderSettings:o,cropSettings:a}=i,{vAlign:n,hAlign:h}=o;return s.width=o.width,s.height=o.height,s.sourceLeft=a.positionX,s.sourceTop=a.positionY,s.sourceWidth=a.width,s.sourceHeight=a.height,s.positionX=o.positionX,s.positionY=o.positionY,s.vAlign=n||"top",s.hAlign=h||"left",s},Dash_UI_Crop_Image=(t,e,i,s,o,a,n)=>{let h=Scalar.InverseLerp(0,t,o),r=Scalar.InverseLerp(0,e,a),l=Scalar.InverseLerp(0,t,i),c=Scalar.InverseLerp(0,e,s),u={x:h,y:1-r},d={x:h+l,y:1-r},p={x:h+l,y:1-r-c},g={x:h,y:1-r-c},m=n?[p.x,p.y,g.x,g.y,u.x,u.y,d.x,d.y]:[d.x,d.y,u.x,u.y,g.x,g.y,p.x,p.y];return[...m,...m]},Dash_AdminTexture$1=Dash_Cache_Texture.create("https://pmacom.github.io/assets/dcldash/images/ui/dash_admin.png");let physicsCast=PhysicsCast.instance;class Dash_Tweaker_Instance{constructor(t){this.target=t,this.container=new UIContainerRect(Dash_GlobalCanvas),this.mode=TweakerMode.POSITION,this.unitValue=1,this.isAnimating=!1,this.initialPosition=new Vector3,this.initialScale=new Vector3,this.initialRotation=new Quaternion,this.inSelectMode=!1,this.selectionEntity=new TweakerSelector,this.container=new UIContainerRect(Dash_GlobalCanvas),this.container.visible=!1,this.container.vAlign="top",this.container.hAlign="left",this.container.width=500,this.container.height=177,this.container.positionX=202,this.container.positionY=20,this.positionUnitButtons=new Dash_UI_ImageRadioButton_Group(this.container,Dash_AdminTexture$1,TweakerPositionUnits,(t=>this.setUnit(parseFloat(t)))),this.rotationUnitButtons=new Dash_UI_ImageRadioButton_Group(this.container,Dash_AdminTexture$1,TweakerRotationUnits,(t=>this.setUnit(parseFloat(t)))),this.rotationUnitButtons.hide(),this.modeToggleButtons=new Dash_UI_ImageRadioButton_Group(this.container,Dash_AdminTexture$1,ModeToggleTabButtons,(t=>{switch(t){case"position":this.setPositionMode(),this.positionUnitButtons.setValue(1),this.setUnit(1);break;case"rotation":this.setRotationMode(),this.rotationUnitButtons.setValue(45),this.setUnit(45)}})),this.modeToggleButtons.setValue("position"),this.staticImages=Dash_UI_Generate_StaticImages(this.container,Dash_AdminTexture$1,TweakerStaticImages),this.scaleButtons=Dash_UI_Generate_StaticButtons(this.container,Dash_AdminTexture$1,TweakerScaleButtonImages,(t=>{this.mode!=TweakerMode.POSITION&&(this.setPositionMode(),this.modeToggleButtons.setValue("position"),this.setUnit(1)),this.isAnimating||this.scale(t)})),this.infoDetailButtons=Dash_UI_Generate_StaticButtons(this.container,Dash_AdminTexture$1,TweakerInfoButtons,(t=>{const{action:e}=t;switch(e){case"log":this.printLog();break;case"revert":this.revert()}})),this.selectButtons=Dash_UI_Generate_StaticButtons(this.container,Dash_AdminTexture$1,SelectButtons,(t=>{const{action:e}=t;switch(e){case"setSelectOn":this.inSelectMode=!0,this.selectionMode.start(),this.setSelectButtonState("setSelectOn");break;case"setSelectOff":this.selectModeStop(),this.setSelectButtonState("setSelectOff");break;case"deselect":this.inSelectMode=!1,this.selectionMode.stop(),this.setTarget(null)}})),this.directionButtons=Dash_UI_Generate_StaticButtons(this.container,Dash_AdminTexture$1,TweakerPositionButtonImages,(t=>{switch(this.mode){case TweakerMode.POSITION:this.isAnimating||this.move(t);break;case TweakerMode.ROTATION:this.isAnimating||this.rotate(t)}})),this.selectionMode=Dash_OnUpdateFrame.add((()=>{this.target?this.selectModeStop():physicsCast.hitFirst(physicsCast.getRayFromCamera(200),(t=>{const{didHit:e,entity:i}=t;if(e&&this.inSelectMode){const{entityId:t,meshName:e}=i,s=engine.entities[t];if("Dash_Tweaker_Selector"!==s.name){const t=s.getComponentOrCreate(Transform).scale.clone();this.selectionEntity.getComponent(Transform).scale=t.add((new Vector3).setAll(.1)),this.selectionTarget=s,this.selectionEntity.setParent(s)}}}))})),this.selectionEntity.addComponent(new OnPointerDown((()=>{this.setTarget(this.selectionTarget),this.selectModeStop()}),{hoverText:"Select Entity",distance:200})),this.infoDetails=new Dash_Admin_Tweaker_InfoDetails(this.container),this.setSelectButtonState("setSelectOff")}setTarget(t){if(t){const{position:e,scale:i,rotation:s}=t.getComponent(Transform);this.infoDetails.setInitialValues("position.x",e.x),this.infoDetails.setInitialValues("position.y",e.y),this.infoDetails.setInitialValues("position.z",e.z),this.infoDetails.setInitialValues("scale.x",i.x),this.infoDetails.setInitialValues("scale.y",i.y),this.infoDetails.setInitialValues("scale.z",i.z),this.infoDetails.setInitialValues("rotation.eulerAngles.x",s.eulerAngles.x,!0),this.infoDetails.setInitialValues("rotation.eulerAngles.y",s.eulerAngles.y,!0),this.infoDetails.setInitialValues("rotation.eulerAngles.z",s.eulerAngles.z,!0),this.infoDetails.setInfo(t),this.initialRotation=s.clone(),this.initialScale=i.clone(),this.initialPosition=e.clone(),this.setSelectButtonState("deselect")}else this.setSelectButtonState("setSelectOff"),this.infoDetails.clear();this.target=t}setSelectButtonState(t){this.selectButtons.forEach((t=>{t.opacity=0,t.isPointerBlocker=!1}));const e=this.selectButtons[0],i=this.selectButtons[1],s=this.selectButtons[2];switch(t){case"setSelectOn":e.opacity=1,e.isPointerBlocker=!0;break;case"setSelectOff":i.opacity=1,i.isPointerBlocker=!0,this.selectModeStop();break;case"deselect":s.opacity=1,s.isPointerBlocker=!0,this.selectModeStop()}}selectModeStop(){this.inSelectMode=!1,this.selectionEntity.setParent(null),this.selectionEntity.alive&&engine.removeEntity(this.selectionEntity),this.selectionMode.stop()}printLog(){if(this.target){const t=this.target.getComponentOrCreate(Transform),{position:e,scale:i,rotation:s}=t,o=[this.formatOutput(e.x),this.formatOutput(e.y),this.formatOutput(e.z)],a=[this.formatOutput(i.x),this.formatOutput(i.y),this.formatOutput(i.z)],n=[this.formatOutput(s.eulerAngles.x),this.formatOutput(s.eulerAngles.y),this.formatOutput(s.eulerAngles.z)];log(`\n\n            Tweaker Output:\n            name: ${this.target.name?this.target.name:"No name"}\n            uuid: ${this.target.uuid}\n\n            Transform({\n               position: new Vector3(${o.join(", ")}),\n               scale: new Vector3(${a.join(", ")}),\n               rotation: new Quaternion().setEuler(${n.join(", ")}),\n            })\n`)}}revert(){if(this.target){const t=this.initialPosition.clone(),e=this.initialScale.clone(),i=this.initialRotation.clone();this.infoDetails.setInitialValues("position.x",t.x),this.infoDetails.setInitialValues("position.y",t.y),this.infoDetails.setInitialValues("position.z",t.z),this.infoDetails.setInitialValues("scale.x",e.x),this.infoDetails.setInitialValues("scale.y",e.y),this.infoDetails.setInitialValues("scale.z",e.z),this.infoDetails.setInitialValues("rotation.eulerAngles.x",i.eulerAngles.x,!0),this.infoDetails.setInitialValues("rotation.eulerAngles.y",i.eulerAngles.y,!0),this.infoDetails.setInitialValues("rotation.eulerAngles.z",i.eulerAngles.z,!0),this.target.addComponentOrReplace(new Transform({position:t,scale:e,rotation:i}))}}formatOutput(t){return parseFloat(`${t}`).toFixed(3)}setPositionMode(){this.mode=TweakerMode.POSITION,this.positionUnitButtons.show(),this.rotationUnitButtons.hide()}setRotationMode(){this.mode=TweakerMode.ROTATION,this.positionUnitButtons.hide(),this.rotationUnitButtons.show()}move(t){if(this.target){const{direction:e,positive:i}=t,s=this.target.getComponent(Transform);if("all"!==e){const t=s.position[e],o=t+(i?this.unitValue:-1*this.unitValue);this.infoDetails.set(`position.${e}`,o),this.isAnimating=!0,Dash_AnimationQueue.add({duration:.2,onFrame:i=>{s.position[e]=Scalar.Lerp(t,o,Dash_Ease.easeOutQuart(i))},onComplete:()=>{s.position[e]=o,this.isAnimating=!1}})}}}scale(t){if(this.target){const{direction:e,positive:i}=t,s=this.target.getComponent(Transform);if("all"!=e){const t=s.scale[e],o=t+(i?this.unitValue:-1*this.unitValue);this.infoDetails.set(`scale.${e}`,o),this.isAnimating=!0,Dash_AnimationQueue.add({duration:.2,onFrame:i=>{s.scale[e]=Scalar.Lerp(t,o,Dash_Ease.easeOutQuart(i))},onComplete:()=>{s.scale[e]=o,this.isAnimating=!1}})}else{const{x:t,y:e,z:o}=s.scale;let a=t+(i?this.unitValue:-1*this.unitValue),n=e+(i?this.unitValue:-1*this.unitValue),h=o+(i?this.unitValue:-1*this.unitValue);this.infoDetails.set("scale.x",a),this.infoDetails.set("scale.y",n),this.infoDetails.set("scale.z",h),this.isAnimating=!0,Dash_AnimationQueue.add({duration:.2,onFrame:i=>{s.scale.set(Scalar.Lerp(t,a,Dash_Ease.easeOutQuart(i)),Scalar.Lerp(e,n,Dash_Ease.easeOutQuart(i)),Scalar.Lerp(o,h,Dash_Ease.easeOutQuart(i)))},onComplete:()=>{s.scale.x=a,s.scale.y=n,s.scale.z=h,this.isAnimating=!1}})}}}rotate(t){if(this.target){const{direction:e,positive:i}=t,s=this.target.getComponent(Transform);if("all"!==e){s.rotation.clone();const t=s.rotation.eulerAngles[e],{x:o,y:a,z:n}=s.rotation.eulerAngles;let h=t+(i?this.unitValue:-1*this.unitValue);switch(e){case"x":this.isAnimating=!0,this.infoDetails.set("rotation.eulerAngles.x",h,!0),this.infoDetails.set("rotation.eulerAngles.y",a,!0),this.infoDetails.set("rotation.eulerAngles.z",n,!0),Dash_AnimationQueue.add({duration:.2,onFrame:e=>{s.rotation.setEuler(Scalar.Lerp(t,h,Dash_Ease.easeOutQuart(e)),a,n)},onComplete:()=>{this.isAnimating=!1,s.rotation.setEuler(h,a,n)}});break;case"y":this.isAnimating=!0,this.infoDetails.set("rotation.eulerAngles.x",o,!0),this.infoDetails.set("rotation.eulerAngles.y",h,!0),this.infoDetails.set("rotation.eulerAngles.z",n,!0),Dash_AnimationQueue.add({duration:.2,onFrame:e=>{s.rotation.setEuler(o,Scalar.Lerp(t,h,Dash_Ease.easeOutQuart(e)),n)},onComplete:()=>{this.isAnimating=!1,s.rotation.setEuler(o,h,n)}});break;case"z":this.isAnimating=!0,this.infoDetails.set("rotation.eulerAngles.x",o,!0),this.infoDetails.set("rotation.eulerAngles.y",a,!0),this.infoDetails.set("rotation.eulerAngles.z",h,!0),Dash_AnimationQueue.add({duration:.2,onFrame:e=>{s.rotation.setEuler(o,a,Scalar.Lerp(t,h,Dash_Ease.easeOutQuart(e)))},onComplete:()=>{this.isAnimating=!1,s.rotation.setEuler(o,a,h)}})}}}}getTarget(){return this.target}setUnit(t){this.unitValue=t}hide(){this.container.visible=!1}show(){this.container.visible=!0}}const Dash_AdminUI_RadioButtons={tweaker:{renderSettings:{positionX:163,positionY:25,width:34,height:34},on:{positionX:515,positionY:262,width:34,height:34},off:{positionX:549,positionY:262,width:34,height:34}}};var Dash_AdminMenu_Mode;!function(t){t[t.NONE=0]="NONE",t[t.TWEAKER=1]="TWEAKER",t[t.ZONE=2]="ZONE"}(Dash_AdminMenu_Mode||(Dash_AdminMenu_Mode={}));const Dash_AdminTexture=Dash_Cache_Texture.create("https://pmacom.github.io/assets/dcldash/images/ui/dash_admin.png");let Dash_AdminMenuInstance;class Dash_AdminMenu{constructor(){this.mode=Dash_AdminMenu_Mode.NONE,this.tweaker=new Dash_Tweaker_Instance,executeTask((()=>__awaiter(this,void 0,void 0,(function*(){(yield isPreviewMode())&&(this.modeSelect=new Dash_UI_AdminRadioButton_Group(Dash_AdminTexture,Dash_AdminUI_RadioButtons,(t=>{switch(t){case"tweaker":this.mode=this.mode!==Dash_AdminMenu_Mode.TWEAKER?Dash_AdminMenu_Mode.TWEAKER:Dash_AdminMenu_Mode.NONE;break;case"zone":this.mode=this.mode!==Dash_AdminMenu_Mode.ZONE?Dash_AdminMenu_Mode.ZONE:Dash_AdminMenu_Mode.NONE}this.updateVisible()})))}))))}updateVisible(){var t;switch(this.hideAll(),this.mode){case Dash_AdminMenu_Mode.TWEAKER:this.tweaker&&this.tweaker.show();break;case Dash_AdminMenu_Mode.ZONE:break;default:null===(t=this.modeSelect)||void 0===t||t.setValue("")}}hideAll(){this.tweaker&&this.tweaker.hide()}}const Dash_Tweaker=t=>{var e,i;Dash_AdminMenuInstance?null===(i=Dash_AdminMenuInstance.tweaker)||void 0===i||i.setTarget(t):(Dash_AdminMenuInstance=new Dash_AdminMenu,null===(e=Dash_AdminMenuInstance.tweaker)||void 0===e||e.setTarget(t))},Dash_Wait=(t,e)=>Dash_AnimationQueue.add({duration:e,onComplete:()=>t()}),getPositionData=()=>{let{feetPosition:t,position:e,rotation:i}=Camera.instance;return JSON.stringify({feetPosition:t,position:e,rotation:i})},Dash_OnFirstMove=t=>{Dash_Wait((()=>{const e=getPositionData(),i=Dash_OnUpdateFrame.add((()=>{const s=getPositionData();e!=s&&(t(),i.stop())}));i.start()}),1)};export{Dash_AdminMenu,Dash_AnimationQueue,Dash_BoxHighlight,Dash_Cache_Texture,Dash_Cache_VideoClip,Dash_Cache_VideoMaterial,Dash_Cache_VideoTexture,Dash_CheckWithinVolume,Dash_Countdown,Dash_Ease,Dash_GetSceneData,Dash_GlobalCanvas,Dash_LandBarrier,Dash_Material,Dash_OnFirstMove,Dash_OnUpdateFrame,Dash_SimplePoster,Dash_TriggerZone,Dash_Tweaker,Dash_UI_Crop_Image,Dash_UI_Generate_StaticButton,Dash_UI_Generate_StaticButtons,Dash_UI_Generate_StaticImages,Dash_UI_StaticImage,Dash_UV_Crop_Video,Dash_UV_Curved_Image,Dash_UV_Curved_Video,Dash_UV_Image,Dash_UV_Plane_Crop_Image,Dash_UV_Video,Dash_Wait,Dash_Zone,Dash_ZoneMaker,DynamicImage,DynamicImageBar};
//# sourceMappingURL=bundle.js.map
